# =============================================================================
# WEELO UNIFIED BACKEND - ENVIRONMENT CONFIGURATION
# =============================================================================
# 
# SETUP INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Update values for your environment
# 3. NEVER commit .env to version control (it's in .gitignore)
# 
# FOR PRODUCTION:
# - Use environment variables or a secrets manager
# - Generate secure secrets using the commands provided below
# =============================================================================

# -----------------------------------------------------------------------------
# SERVER
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
HOST=localhost

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
# Current: JSON file (development) - stored in ~/.weelo-data/
# Production: PostgreSQL connection string
DATABASE_URL=postgresql://localhost:5432/weelo_db

# -----------------------------------------------------------------------------
# REDIS (Required for Production Scalability)
# -----------------------------------------------------------------------------
# Used for: 
#   - OTP storage (auto-expire)
#   - Refresh tokens (session management)
#   - Driver availability (geospatial queries)
#   - Truck holds (distributed locks)
#   - Rate limiting (sliding window)
#   - Real-time pub/sub (multi-server WebSocket sync)
# 
# Development: Set REDIS_ENABLED=false to use in-memory storage
# Production: Set REDIS_ENABLED=true and provide REDIS_URL
#
# For millions of users, Redis is NON-NEGOTIABLE for horizontal scaling
REDIS_ENABLED=false
REDIS_URL=redis://localhost:6379

# Advanced Redis Settings (optional)
REDIS_MAX_RETRIES=10
REDIS_RETRY_DELAY_MS=1000
REDIS_MAX_CONNECTIONS=50
REDIS_CONNECTION_TIMEOUT_MS=10000
REDIS_COMMAND_TIMEOUT_MS=5000

# -----------------------------------------------------------------------------
# JWT AUTHENTICATION (SECURITY CRITICAL)
# -----------------------------------------------------------------------------
# ‚ö†Ô∏è  IMPORTANT: Generate secure secrets for production!
#
# Generate JWT_SECRET:
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# Generate JWT_REFRESH_SECRET (use a DIFFERENT secret):
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# In development, leave these empty - they will be auto-generated
# In production, these MUST be set or the server will fail to start
JWT_SECRET=
JWT_REFRESH_SECRET=
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# -----------------------------------------------------------------------------
# OTP CONFIGURATION
# -----------------------------------------------------------------------------
OTP_EXPIRY_MINUTES=5
OTP_LENGTH=6
OTP_MAX_ATTEMPTS=3

# -----------------------------------------------------------------------------
# SMS PROVIDER
# -----------------------------------------------------------------------------
# Options: console (dev), twilio, msg91
# 
# Development: Use "console" - OTPs are logged to server console
# Production: Use "twilio" or "msg91" with proper credentials
SMS_PROVIDER=console

# Twilio Configuration (https://www.twilio.com/)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# MSG91 Configuration (https://msg91.com/ - recommended for India)
MSG91_AUTH_KEY=
MSG91_SENDER_ID=WEELO
MSG91_TEMPLATE_ID=

# -----------------------------------------------------------------------------
# GOOGLE MAPS (Places, Geocoding, Directions)
# -----------------------------------------------------------------------------
# Required in production for search suggestions
GOOGLE_MAPS_API_KEY=

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
# Options: debug, info, warn, error
# Production recommendation: info or warn
LOG_LEVEL=debug

# -----------------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing)
# -----------------------------------------------------------------------------
# Development: Use * (allows all origins)
# Production: Comma-separated list of allowed domains
#   Example: https://weelo.app,https://captain.weelo.app
CORS_ORIGIN=*

# -----------------------------------------------------------------------------
# SECURITY FEATURES
# -----------------------------------------------------------------------------
ENABLE_SECURITY_HEADERS=true
ENABLE_RATE_LIMITING=true
ENABLE_REQUEST_LOGGING=true

# -----------------------------------------------------------------------------
# AWS LOCATION SERVICE (Optional - for accurate routing)
# -----------------------------------------------------------------------------
# Enable AWS Location for real road distances and truck-specific routing
# Disabled by default - falls back to Haversine calculation
AWS_LOCATION_ENABLED=false
AWS_REGION=ap-south-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_LOCATION_ROUTE_CALCULATOR=weelo-routes
AWS_LOCATION_PLACE_INDEX=weelo-places

# =============================================================================
# üöÄ PRODUCTION DEPLOYMENT CHECKLIST
# =============================================================================
# 
# Before deploying to production, ensure ALL of the following:
# 
# ‚úÖ ENVIRONMENT
#    [ ] NODE_ENV=production
#    [ ] LOG_LEVEL=info or warn
# 
# ‚úÖ SECURITY (CRITICAL)
#    [ ] JWT_SECRET is a 64+ byte random hex string
#    [ ] JWT_REFRESH_SECRET is a DIFFERENT 64+ byte random hex string
#    [ ] CORS_ORIGIN is restricted to your domains only
#    [ ] ENABLE_SECURITY_HEADERS=true
#    [ ] ENABLE_RATE_LIMITING=true
# 
# ‚úÖ SCALABILITY
#    [ ] REDIS_ENABLED=true
#    [ ] REDIS_URL points to production Redis cluster
#    [ ] DATABASE_URL points to production PostgreSQL
# 
# ‚úÖ SMS (Required for real OTPs)
#    [ ] SMS_PROVIDER=twilio or msg91
#    [ ] SMS provider credentials are set
# 
# ‚úÖ INFRASTRUCTURE
#    [ ] HTTPS/TLS configured on load balancer
#    [ ] SSL certificates installed
#    [ ] Firewall rules configured
#    [ ] Monitoring and alerting set up
# 
# =============================================================================
